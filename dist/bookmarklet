javascript:(function(){if(!document.location.href.match(/^https?:\/\/analytics\.twitter\.com/)){return}Date.prototype.getYearMonth=function(e){if(!e){e=false}year=this.getFullYear();month=("00"+(this.getMonth()+1)).slice(-2);return e?year+"/"+month:parseInt(year+month)};today=new Date;since=window.prompt("いつ以降のデータを取得しますか？ (YYYY/MM)",today.getYearMonth(true));if(!since){return}sinceDate=new Date(since+"/1");timer=setInterval(function(){document.querySelector("html,body").scrollTop=document.querySelector("html,body").scrollHeight;blocks=document.querySelectorAll(".home-page");oldestTimestamp=blocks[blocks.length-1].getAttribute("data-start");oldestDate=new Date(parseInt(oldestTimestamp));if(oldestDate.getYearMonth()<=sinceDate.getYearMonth()||oldestDate.getYearMonth()<=201409){clearInterval(timer);blocks=document.querySelectorAll(".home-page");table=[["年月","ツイート","ツイートインプレッション","プロフィールへのアクセス","@ツイート","新しいフォロワー"]];blocks.forEach(function(e){timestamp=e.getAttribute("data-start");date=new Date(parseInt(timestamp));if(date.getYearMonth()<sinceDate.getYearMonth()){return false}tweetsElem=e.querySelector(".metric-tweets");impressionsElem=e.querySelector(".metric-tweetviews");profileViewsElem=e.querySelector(".metric-profile-views");mentionsElem=e.querySelector(".metric-mentions");newFollowersElem=e.querySelector(".metric-followers");tweets=tweetsElem?tweetsElem.textContent.replace(",",""):"";impressions=impressionsElem?impressionsElem.textContent.replace(",",""):"";profileViews=profileViewsElem?profileViewsElem.textContent.replace(",",""):"";mentions=mentionsElem?mentionsElem.textContent.replace(",",""):"";newFollowers=newFollowersElem?newFollowersElem.textContent.replace(",",""):"";table.push([date.getYearMonth(true),tweets,impressions,profileViews,mentions,newFollowers])});tsv="";table.forEach(function(e){tsv+=e.join("\t")+"\n"});w=window.open("","","height=500, width=800");if(!w){alert("ポップアップがブロックされました。ポップアップを許可してから再度実行してください。")}else{w.document.open();w.document.write("<pre>"+tsv+"</pre>");w.document.close()}}},500)})();
